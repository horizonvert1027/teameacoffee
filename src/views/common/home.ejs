<% articles.forEach(function(article) { let tags = article.json.tags; 
  let metatags = tags.map(s => '<a href="/tags/'+s+'">#'+s+'</a>').join(' '); 
  var catg=article.json.category;var category = catg.charAt(0).toUpperCase() + catg.slice(1);let upvotes=JSON.stringify(article.votes); if(article.likes>0){postIncome=((article.dist)/1000000).toString()}else{postIncome=0}%><% if(article.__promoted) { %><div class="promoted_sec"><span class="promoted_icon"><svg width="20px" height="20px" viewBox="0 0 30 30"><path d="M 5 5 L 5 27 L 27 27 L 27 5 Z M 7 7 L 25 7 L 25 25 L 7 25 Z M 13 10 L 13 12 L 18.5625 12 L 9.28125 21.28125 L 10.71875 22.71875 L 20 13.4375 L 20 19 L 22 19 L 22 10 Z" /></svg></span><span class="promoted_title">Promoted</span></div><% } %>
<div class="inner-card-wrapper">
  <div class="card-userPic-wrapper">
    <a href="/profile/<%- article.author %>"><%if(article.user){%><img alt="<%- article.author %>" width="100%" height="49px" src="<%- article.user.profile.avatar%>" class="home_pro_pic" /> <%}else{%><img alt="<%- article.author %>" width="100%" height="49px" src="/images/user.png" class="home_pro_pic" /><%}%></a>
  </div>
  <div class="card-content-wrapper">
    <div class="card-content-header"><div class="card-header-detail"><span class="card-header-username"><a href="/profile/<%- article.author %>">@<b><%- article.author %></b></a></span><span><small> in</small><a href="/category/<%- (article.json.category).toLowerCase() %>" class="card_home_cat"> <%- category %></a></span><% if(!(article.__promoted)) {%><span class="card-header-dot">-</span><span class="card-header-date"><%- moment.utc(article.ts).fromNow()%></span><% } %></div></div>
    <%if(article.json && article.json.type){var hashregex = /(^|\B)#(?![0-9_]+\b)([a-zA-Z0-9_]{1,30})(\b|\r)/g;var content=article.json.body;var ptags = content.match(hashregex);if(ptags){for(var i = 0, l = ptags.length; i < l; i++ ){content=content.replace(ptags[i], '<a style="color:rgb(0 43 255)" href="/tags/'+ptags[i].replace(/#/g, '').toLowerCase()+'">'+ptags[i]+'</a>');};};
      if(article.json.type==3){%><div class="post-content" data-permlink="<%- article.link %>" data-author="<%- article.author %>"><p><%- content %></p></div>
      <%}else if(article.json.type==2){%><div class="post-content" data-permlink="<%- article.link %>" data-author="<%- article.author %>"><p><%- content %></p></div><div class="card-content-images"><a href="/post/<%- article.author %>/<%- article.link %>"><div class="card-image-link"><img alt="<%- article.link %>" src="<%- article.json.image %>" /></div></a></div>
      <%}else if(article.json.type==1){%><div class="card-content-info card_home_title"><a href="/post/<%- article.author %>/<%- article.link %>"><%- article.json.title %></a></div>
      <div class="card-content-info card_home_tags"><%- metatags.toString() %></div>
      <div class="card-content-images"><a href="/post/<%- article.author %>/<%- article.link %>">
      <div class="card-image-link"><iframe width="100%" height="auto" style="border: none;border-radius: 14px;min-height: 255px;" src="https://youtube.com/embed/<%-article.json.videoid%>?mute=1"></iframe></div></a></div>
      <%}else if(article.json.type==0){ if(!article.json.image || article.json.image === undefined){var iimg='/images/img-tmac.png';}else{var iimg=article.json.image;};%><div class="card-content-info card_home_title"><a href="/post/<%- article.author %>/<%- article.link %>"><%- article.json.title %></a></div>
      <div class="card-content-info card_home_tags"><%- metatags.toString() %></div>
      <div class="card-content-images"><a href="/post/<%- article.author %>/<%- article.link %>"><div class="card-image-link"><img alt="<%- article.link %>" src="<%- iimg %>" /></div></a></div>
      <%}%>
    <%}else{%><div class="card-content-info card_home_title"><a href="/post/<%- article.author %>/<%- article.link %>"><%- article.json.title %></a></div>
    <div class="card-content-info card_home_tags"><%- metatags.toString() %></div>
    <div class="card-content-images"><a href="/post/<%- article.author %>/<%- article.link %>"><div class="card-image-link"><img alt="<%- article.link %>" src="<%- article.json.image %>" /></div></a></div>
    <%}%>
  <div class="card-buttons-wrapper likes_section"><div class="card-button-wrap"><% if((loguser) && upvotes.includes(loguser)){%><div class="hov_up"></div><div class="likes-value"><%- article.likes %></div><% }else{ %><div class="card-icon" data-permlink="<%- article.link %>" data-author="<%- article.author %>"><svg x="0px" y="0px" viewBox="0 0 117.57 122.88"><g><path d="M113.6,74.1c-0.77-1.4-1.91-2.47-3.22-3.18l1.88-1.03c1.92-1.06,3.23-2.8,3.8-4.75c0.57-1.96,0.39-4.13-0.66-6.05 c0,0,0-0.01,0-0.01c-0.78-1.42-1.99-2.57-3.44-3.28l1.51-0.83c1.92-1.06,3.23-2.8,3.8-4.75c0.57-1.96,0.39-4.13-0.66-6.05 c-1.05-1.92-2.8-3.23-4.75-3.79c-1.96-0.57-4.13-0.39-6.05,0.66l-1.54,0.85c0.15-1.53-0.15-3.12-0.94-4.57 c-1.05-1.92-2.8-3.23-4.75-3.8c-1.96-0.57-4.13-0.39-6.05,0.66l-7.92,4.36c-0.85-1.86-2.32-3.45-4.3-4.41c0,0-0.01,0-0.01,0 c-1.68-0.81-3.56-1.09-5.4-0.8l0.87-1.78c1.1-2.26,1.18-4.76,0.41-6.97c-0.76-2.21-2.37-4.13-4.63-5.23 c-2.26-1.1-4.76-1.18-6.97-0.41c-2.21,0.76-4.13,2.37-5.23,4.62l-0.88,1.81c-0.88-1.53-2.21-2.83-3.91-3.66 c-2.26-1.1-4.76-1.18-6.97-0.41c-2.21,0.76-4.13,2.37-5.23,4.63L23.36,64.92c-0.43,0.63-0.82,1.29-1.16,1.98l0,0l-1.12,2.29 l-0.11-0.29c-0.77-2.01-1.47-4.07-1.74-4.84c-1.79-5.21-5.2-7.79-8.65-8.29c-1.56-0.23-3.1-0.03-4.51,0.53 c-1.41,0.56-2.68,1.49-3.7,2.73c-2.41,2.93-3.37,7.63-1.04,13.32l0.03,0.1l0,0l0.01,0.02c2.47,7.27,8.27,29.5,14.65,36.5 c7.89,8.66,28.31,16.78,39.3,12.91c6.06-2.13,11.32-6.59,14.36-12.83l1.13-2.32c13.22-7.27,26.43-14.55,39.66-21.83 c1.92-1.05,3.23-2.8,3.79-4.75C114.83,78.2,114.66,76.02,113.6,74.1L113.6,74.1L113.6,74.1z M85.43,42.19 c2.93-1.6,5.88-3.21,8.83-4.84c1.04-0.57,2.23-0.67,3.3-0.36c1.07,0.31,2.02,1.02,2.59,2.07c0.57,1.04,0.67,2.23,0.36,3.3 c-0.31,1.07-1.02,2.02-2.07,2.59l-8.98,4.94c-0.29-0.18-0.58-0.35-0.9-0.5l0,0c-1.65-0.8-3.43-1.06-5.13-0.84l1.08-2.21 C85.16,45,85.45,43.58,85.43,42.19L85.43,42.19z M92.22,52.64l15.32-8.43c1.04-0.57,2.23-0.67,3.3-0.36 c1.07,0.31,2.02,1.02,2.59,2.07c0.57,1.04,0.67,2.23,0.36,3.3c-0.31,1.07-1.02,2.02-2.07,2.59L92.35,62.46l0.42-0.87 c1.1-2.26,1.18-4.76,0.41-6.97C92.95,53.93,92.62,53.26,92.22,52.64L92.22,52.64z M89.45,68.42l16.88-9.29 c1.04-0.57,2.23-0.67,3.3-0.36c1.07,0.31,2.02,1.02,2.59,2.07c0.57,1.04,0.67,2.23,0.36,3.3c-0.31,1.07-1.02,2.02-2.07,2.59 L87.73,79.26l1.74,3.17l15.07-8.29c1.04-0.57,2.23-0.67,3.3-0.36c1.07,0.31,2.02,1.02,2.59,2.07c0.57,1.04,0.67,2.23,0.36,3.3 c-0.31,1.07-1.02,2.02-2.07,2.59C97,88.19,85.28,94.64,73.56,101.09L89.45,68.42L89.45,68.42z M65.95,107.24 c-2.55,5.23-6.94,8.97-12.01,10.75c-9.36,3.3-28.17-4.45-34.87-11.8C13.38,99.95,7.11,76.52,5.29,71.15 c-0.02-0.09-0.06-0.19-0.09-0.28l-1.92,0.79l1.91-0.79c-1.7-4.1-1.16-7.32,0.4-9.21c0.57-0.69,1.26-1.2,2.02-1.5 c0.76-0.3,1.57-0.41,2.38-0.29c2.04,0.3,4.12,2.01,5.34,5.54c0.28,0.81,1.02,2.96,1.79,4.97c0.72,1.89,1.51,3.75,2.16,4.69 c0.2,0.35,0.51,0.63,0.88,0.81c0,0,0,0,0,0l1.83,0l4.02-7.14C32.68,55,39.36,41.52,46.08,27.73c0.6-1.23,1.65-2.1,2.86-2.52 c1.21-0.42,2.57-0.38,3.8,0.22c1.23,0.6,2.1,1.65,2.52,2.85c0.42,1.21,0.38,2.57-0.22,3.8L42.01,58.85l3.86,1.88l17.21-35.36 c0.6-1.23,1.65-2.1,2.85-2.52c1.21-0.42,2.57-0.38,3.8,0.22c1.23,0.6,2.1,1.65,2.52,2.86c0.42,1.21,0.38,2.57-0.22,3.8L54.82,65.09 l3.94,1.92l13.07-26.85c0.6-1.23,1.65-2.1,2.86-2.52c1.21-0.42,2.57-0.38,3.8,0.22c1.23,0.6,2.1,1.65,2.52,2.86 c0.42,1.21,0.38,2.57-0.22,3.8L67.71,71.36l3.73,1.82l8.64-17.76c0.6-1.23,1.64-2.1,2.85-2.52c1.21-0.42,2.57-0.38,3.8,0.22 c1.23,0.6,2.1,1.65,2.52,2.86c0.41,1.21,0.38,2.57-0.22,3.8C81.34,75.6,73.65,91.42,65.95,107.24L65.95,107.24z M82.16,14.53 c-0.01,1.36-1.12,2.46-2.48,2.44c-1.36-0.01-2.46-1.12-2.44-2.48L77.3,2.58c0.01-1.36,1.12-2.46,2.48-2.44 c1.36,0.01,2.46,1.12,2.44,2.48L82.16,14.53L82.16,14.53z M95.14,14.37c-0.54,1.25-2,1.82-3.25,1.28c-1.25-0.54-1.82-2-1.28-3.25 l4.78-10.91c0.54-1.25,2-1.82,3.25-1.28c1.25,0.54,1.82,2,1.28,3.25L95.14,14.37L95.14,14.37z M100,26.05 c-1.11,0.79-2.65,0.54-3.44-0.57c-0.79-1.11-0.54-2.65,0.57-3.44l10.99-7.88c1.11-0.79,2.65-0.54,3.44,0.57 c0.79,1.11,0.54,2.65-0.57,3.44L100,26.05L100,26.05z"/></g></svg></div><div class="card-icon-value"><%- article.likes %></div><%}%></div><div class="card-button-wrap"><span class="post-income"><%-postIncome%></span>&nbsp;TMAC</div></div>
</div>
</div><% }) %>